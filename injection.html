<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 21 December 2013
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Frank Martinez" />
    <meta name="author" content="Eduardo Macarron" />
    <meta name="Date-Revision-yyyymmdd" content="20131221" />
    <meta http-equiv="Content-Language" content="en" />
    <title>MyBatis - 
    MyBatis-CDI | Injecting MyBatis beans</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.0.min.js"></script>

    
            </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>MyBatis CDI Module</h2>
                </div>
                      </div>
        <div class="pull-right">                  <a href="http://www.mybatis.org/" id="bannerRight" title="MyBatis logo">
                                                                                        <img src="http://mybatis.github.io/images/mybatis-logo.png"  alt="MyBatis logo"/>
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 21 December 2013</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 1.0-SNAPSHOT</li>
                      
                
                    
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Reference Documentation</li>
                                
      <li>
    
                          <a href="index.html" title="Introduction">
          <i class="none"></i>
        Introduction</a>
            </li>
                  
      <li>
    
                          <a href="getting-started.html" title="Getting Started">
          <i class="none"></i>
        Getting Started</a>
            </li>
                  
      <li class="active">
    
            <a href="#"><i class="none"></i>Injecting beans</a>
          </li>
                  
      <li>
    
                          <a href="transactions.html" title="Transactions">
          <i class="none"></i>
        Transactions</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                                                                                          
      <li>
    
                          <a href="project-info.html" title="Project Information">
          <i class="icon-chevron-right"></i>
        Project Information</a>
                  </li>
                                                                                                                                                                                                                                      
      <li>
    
                          <a href="project-reports.html" title="Project Reports">
          <i class="icon-chevron-right"></i>
        Project Reports</a>
                  </li>
            </ul>
                
                    
                
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <!-- Copyright 2013 the original author or authors.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License. --><!-- version: $Id$ -->

  
    <div class="section">
<h2>Injecting MyBatis beans<a name="Injecting_MyBatis_beans"></a></h2>
      
    
<div class="section">
<h3>Selecting the Factory<a name="Selecting_the_Factory"></a></h3>
      
<p>
        In base MyBatis, the <tt>SqlSessionFactory</tt> is built using <tt>SqlSessionFactoryBuilder</tt>. 
        In MyBatis-CDI it is produced by any bean with a method annotated with <tt>@Prouces</tt>.
      </p>

      
<p>
        MyBatis-CDI lets you have more than one <tt>SqlSessionFactory</tt> and you can choose the one you want to use
        in any injection point by using:
      </p>
      
      
<ul>
        
<li>One or more qualifiers</li>
        
<li>The name of the <tt>SqlSessionFactory</tt></li>
        
<li>Any paranoic combination or both</li>
      </ul>
	</div>      
      
    
<div class="section">
<h3>Selecting a Factory by using qualifiers<a name="Selecting_a_Factory_by_using_qualifiers"></a></h3>
      
      
<p>
        If you have more than one <tt>SqlSessionFactory</tt>s you can differentiate them by adding qualifiers as you would
        do with any other CDI bean:
      </p>

        
<div class="source">
<pre>
  @ApplicationScoped  @Produces  @OneQualifier  public SqlSessionFactory createManagerOne() throws IOException {
    ...
  }
  
  @ApplicationScoped  @Produces  @OtherQualifier  public SqlSessionFactory createManagerTwo() throws IOException {
    ...
  }</pre></div>
    
      
<p>
        Now that there is no ambiguity you can select what factory you want to inject to a bean by adding the qualifiers to it:
      </p>
    
        
<div class="source">
<pre>
@Inject @Mapper @OneQualifier private UserMapper userMapper;
</pre></div>    
    </div>
      
    
<div class="section">
<h3>Selecting a Factory by its name<a name="Selecting_a_Factory_by_its_name"></a></h3>
    
      
<p>
        You can also give a name to your <tt>SqlSessionFactory</tt> and refer to it by its name in a injection point:
      </p>

        
<div class="source">
<pre>
  @ApplicationScoped
  @Produces
  @Named(&quot;fooManager&quot;)
  public SqlSessionFactory createManager() throws IOException {
    ...
  }
</pre></div>
      
      
<p>And inject it as follows:
      </p>
      
        
<div class="source">
<pre>
@Inject @Mapper @Named(&quot;fooManager&quot;) private UserMapper userMapper;
</pre></div>    
      
      </div>
      
    
<div class="section">
<h3>Injecting an SqlSession<a name="Injecting_an_SqlSession"></a></h3>

	  
<p>You can also inject an <tt>SqlSession</tt> by requesting its injection as follows:</p>
	  
        
<div class="source">
<pre>
@Inject private SqlSession sqlSession;
</pre></div>    

	  
<p>The factory selection criteria we saw for mappers apply also to <tt>SqlSession</tt> injection.</p>
	  
      
<p><span class="label important">NOTE</span>
        MyBatis-CDI controls the lifecycle of the injected <tt>SqlSession</tt> so you must not call any transactional method
        like <tt>commit()</tt> or <tt>rollback</tt>, nor any lifecycle method like <tt>close()</tt>.
      </p>
	  
	</div>      
    </div>
  

                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                    2010-2013
                        <a href="http://www.mybatis.org/">MyBatis.org</a>.
            All Rights Reserved.      
                    
      </div>

        
        
                </div>
    </footer>
  </body>
</html>
